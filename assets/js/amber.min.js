var Amber=function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c={join:"join",leave:"leave",message:"message"},r=function(){return(new Date).getTime()},s=function(e){return(r()-e)/1e3},a=t.Channel=function(){function e(t,n){o(this,e),this.topic=t,this.socket=n,this.onMessageHandlers=[]}return i(e,[{key:"join",value:function(){this.socket.ws.send(JSON.stringify({event:c.join,topic:this.topic}))}},{key:"leave",value:function(){this.socket.ws.send(JSON.stringify({event:c.leave,topic:this.topic}))}},{key:"handleMessage",value:function(e){this.onMessageHandlers.forEach(function(t){t.subject===e.subject&&t.callback(e.payload)})}},{key:"on",value:function(e,t){this.onMessageHandlers.push({subject:e,callback:t})}},{key:"push",value:function(e,t){this.socket.ws.send(JSON.stringify({event:c.message,topic:this.topic,subject:e,payload:t}))}}]),e}();t.Socket=function(){function e(t){o(this,e),this.endpoint=t,this.ws=null,this.channels=[],this.lastPing=r(),this.reconnectTries=0,this.attemptReconnect=!0}return i(e,[{key:"_connectionIsStale",value:function(){return s(this.lastPing)>100}},{key:"_reconnect",value:function(){var e=this;clearTimeout(this.reconnectTimeout),this.reconnectTimeout=setTimeout(function(){e.reconnectTries++,e.connect(e.params),e._reconnect()},this._reconnectInterval())}},{key:"_reconnectInterval",value:function(){return[1e3,2e3,5e3,1e4][this.reconnectTries]||1e4}},{key:"_poll",value:function(){var e=this;this.pollingTimeout=setTimeout(function(){e._connectionIsStale()?e._reconnect():e._poll()},1e4)}},{key:"_startPolling",value:function(){clearTimeout(this.pollingTimeout),this._poll()}},{key:"_handlePing",value:function(){this.lastPing=r()}},{key:"_reset",value:function(){clearTimeout(this.reconnectTimeout),this.reconnectTries=0,this.attemptReconnect=!0,this._startPolling()}},{key:"connect",value:function(e){var t=this;this.params=e;var n={location:window.location.hostname,port:window.location.port,protocol:"https:"===window.location.protocol?"wss:":"ws:"};return e&&Object.assign(n,e),n.port&&(n.location+=":"+n.port),new Promise(function(e,o){t.ws=new WebSocket(n.protocol+"//"+n.location+t.endpoint),t.ws.onmessage=function(e){t.handleMessage(e)},t.ws.onclose=function(){t.attemptReconnect&&t._reconnect()},t.ws.onopen=function(){t._reset(),e()}})}},{key:"disconnect",value:function(){this.attemptReconnect=!1,clearTimeout(this.pollingTimeout),clearTimeout(this.reconnectTimeout),this.ws.close()}},{key:"channel",value:function(e){var t=new a(e,this);return this.channels.push(t),t}},{key:"handleMessage",value:function(e){if("ping"===e.data)return this._handlePing();var t=JSON.parse(e.data);this.channels.forEach(function(e){e.topic===t.topic&&e.handleMessage(t)})}}]),e}();document.addEventListener("DOMContentLoaded",function(){var e,t=document.querySelectorAll("a[data-method='delete']");for(e=0;e<t.length;e++)t[e].addEventListener("click",function(e){e.preventDefault();var t=e.target.getAttribute("data-confirm")||"Are you sure?";if(confirm(t)){var n=document.createElement("form"),o=document.createElement("input");n.setAttribute("action",e.target.getAttribute("href")),n.setAttribute("method","POST"),o.setAttribute("type","hidden"),o.setAttribute("name","_method"),o.setAttribute("value","DELETE"),n.appendChild(o),document.body.appendChild(n),n.submit()}return!1})}),Date.prototype.toGranite||function(){function e(e){return e<10?"0"+e:e}Date.prototype.toGranite=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+" "+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())}}()}]);